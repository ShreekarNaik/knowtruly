import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useMemo } from "react";
import { useAuditLog } from "../../hooks/useAuditLog";
import { useMatchResults } from "../../hooks/useMatchResults";
import { useProfile } from "../../hooks/useProfile";
import { useResumeList } from "../../hooks/useResumes";
export var StudentDashboardPage = function () {
    var _a, _b, _c, _d;
    var profile = useProfile().data;
    var resumes = useResumeList().data;
    var matchQuery = useMemo(function () { return ({
        roleDescriptor: {
            title: "Frontend Lead",
            description: "Lead end-to-end delivery of the KnowTruly recruiter portal experience.",
            requiredSkills: ["React", "TypeScript", "FastAPI"]
        },
        topK: 3
    }); }, []);
    var matchData = useMatchResults({ query: matchQuery }).data;
    var auditLog = useAuditLog(profile === null || profile === void 0 ? void 0 : profile.id).data;
    return (_jsxs("section", { className: "space-y-8", children: [_jsxs("div", { className: "flex flex-col gap-4 rounded-3xl border border-slate-800 bg-gradient-to-r from-[#0f1624] to-[#101b2c] p-8 shadow-2xl md:flex-row md:items-center md:justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-xs uppercase tracking-[0.3em] text-slate-500", children: "Digital Twin" }), _jsx("h1", { className: "mt-2 text-3xl font-semibold text-slate-100", children: (_a = profile === null || profile === void 0 ? void 0 : profile.canonicalName) !== null && _a !== void 0 ? _a : "Loading profile..." }), _jsx("p", { className: "mt-3 max-w-2xl text-sm text-slate-300", children: profile === null || profile === void 0 ? void 0 : profile.summary })] }), _jsxs("div", { className: "grid gap-3 sm:grid-cols-3", children: [_jsxs("div", { className: "rounded-2xl border border-sky-500/40 bg-sky-500/10 p-4 text-sky-200", children: [_jsx("p", { className: "text-2xl font-semibold", children: (_b = profile === null || profile === void 0 ? void 0 : profile.skills.length) !== null && _b !== void 0 ? _b : 0 }), _jsx("p", { className: "text-xs uppercase tracking-[0.25em]", children: "Skills tracked" })] }), _jsxs("div", { className: "rounded-2xl border border-emerald-500/40 bg-emerald-500/10 p-4 text-emerald-200", children: [_jsx("p", { className: "text-2xl font-semibold", children: (_c = resumes === null || resumes === void 0 ? void 0 : resumes.length) !== null && _c !== void 0 ? _c : 0 }), _jsx("p", { className: "text-xs uppercase tracking-[0.25em]", children: "Resumes" })] }), _jsxs("div", { className: "rounded-2xl border border-violet-500/40 bg-violet-500/10 p-4 text-violet-200", children: [_jsx("p", { className: "text-2xl font-semibold", children: (_d = matchData === null || matchData === void 0 ? void 0 : matchData.matches.length) !== null && _d !== void 0 ? _d : 0 }), _jsx("p", { className: "text-xs uppercase tracking-[0.25em]", children: "Live matches" })] })] })] }), _jsxs("div", { className: "grid gap-6 lg:grid-cols-2", children: [_jsxs("section", { className: "rounded-2xl border border-slate-800 bg-[#0f141c] p-6", children: [_jsxs("header", { className: "flex items-center justify-between", children: [_jsx("h2", { className: "text-lg font-semibold text-slate-100", children: "Recent resume snapshots" }), _jsx("span", { className: "text-xs uppercase tracking-[0.25em] text-slate-500", children: "Typst pipeline" })] }), _jsxs("div", { className: "mt-4 space-y-3", children: [resumes === null || resumes === void 0 ? void 0 : resumes.map(function (resume) { return (_jsxs("article", { className: "flex items-center justify-between rounded-xl border border-slate-800 bg-slate-900/40 px-4 py-3 text-sm", children: [_jsxs("div", { children: [_jsx("p", { className: "font-semibold text-slate-200", children: resume.name }), _jsxs("p", { className: "text-xs text-slate-500", children: ["Updated ", new Date(resume.updatedAt).toLocaleDateString(), " \u00B7 Template ", resume.templateId] })] }), _jsxs("div", { className: "flex items-center gap-2 text-xs text-slate-400", children: [_jsx("progress", { max: 100, value: resume.progress, className: "h-2 w-20 overflow-hidden rounded-full bg-slate-800 [&::-webkit-progress-value]:bg-sky-500 [&::-webkit-progress-bar]:bg-slate-800" }), _jsxs("span", { children: [resume.progress, "%"] })] })] }, resume.id)); }), !(resumes === null || resumes === void 0 ? void 0 : resumes.length) && _jsx("p", { className: "text-sm text-slate-500", children: "No resumes generated yet." })] })] }), _jsxs("section", { className: "rounded-2xl border border-slate-800 bg-[#0f141c] p-6", children: [_jsxs("header", { className: "flex items-center justify-between", children: [_jsx("h2", { className: "text-lg font-semibold text-slate-100", children: "Latest match explanations" }), _jsx("span", { className: "text-xs uppercase tracking-[0.25em] text-slate-500", children: "Semantic engine" })] }), _jsxs("div", { className: "mt-4 space-y-3", children: [matchData === null || matchData === void 0 ? void 0 : matchData.matches.map(function (match) { return (_jsxs("article", { className: "rounded-xl border border-slate-800 bg-slate-900/40 p-4", children: [_jsxs("div", { className: "flex items-center justify-between text-sm", children: [_jsxs("p", { className: "font-semibold text-slate-200", children: ["Score ", (match.score * 100).toFixed(0), "%"] }), _jsxs("p", { className: "text-xs text-slate-500", children: ["Matched ", new Date(match.matchedAt).toLocaleDateString()] })] }), _jsx("p", { className: "mt-2 text-xs uppercase tracking-[0.2em] text-slate-500", children: "Top skills" }), _jsx("div", { className: "mt-2 flex flex-wrap gap-2", children: match.explanation.topMatchingSkills.map(function (skill) { return (_jsxs("span", { className: "rounded-full bg-sky-500/10 px-3 py-1 text-xs text-sky-200", children: [skill.skill, " \u00B7 ", (skill.confidence * 100).toFixed(0), "%"] }, skill.skill)); }) }), match.explanation.gaps.length > 0 && (_jsxs("p", { className: "mt-2 text-xs text-amber-300", children: ["Gap: ", match.explanation.gaps[0]] }))] }, match.candidateId)); }), !(matchData === null || matchData === void 0 ? void 0 : matchData.matches.length) && _jsx("p", { className: "text-sm text-slate-500", children: "Run a role match to see results." })] })] })] }), _jsxs("section", { className: "rounded-2xl border border-slate-800 bg-[#0f141c] p-6", children: [_jsxs("header", { className: "flex items-center justify-between", children: [_jsx("h2", { className: "text-lg font-semibold text-slate-100", children: "Audit activity" }), _jsx("span", { className: "text-xs uppercase tracking-[0.25em] text-slate-500", children: "Trust trail" })] }), _jsxs("div", { className: "mt-4 space-y-3", children: [auditLog === null || auditLog === void 0 ? void 0 : auditLog.logs.map(function (log) {
                                var _a;
                                return (_jsxs("div", { className: "flex items-center justify-between rounded-xl border border-slate-800 bg-slate-900/40 px-4 py-3 text-sm", children: [_jsxs("div", { children: [_jsx("p", { className: "font-semibold text-slate-200", children: log.action.replace("_", " ") }), _jsxs("p", { className: "text-xs text-slate-500", children: [(_a = log.actorName) !== null && _a !== void 0 ? _a : log.actorId, " \u00B7 ", new Date(log.timestamp).toLocaleString()] })] }), _jsx("span", { className: "rounded-full bg-slate-800 px-3 py-1 text-xs text-slate-400", children: Object.keys(log.metadata).join(", ") })] }, log.timestamp));
                            }), !(auditLog === null || auditLog === void 0 ? void 0 : auditLog.logs.length) && _jsx("p", { className: "text-sm text-slate-500", children: "No audit entries yet." })] })] })] }));
};
